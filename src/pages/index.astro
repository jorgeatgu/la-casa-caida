---
import BaseLayout from '../layouts/Layout.astro';
import { aragonStacked } from '../scripts/d3/aragonStacked';
import { scatterDesert } from '../scripts/d3/scatterDesert';
---
<BaseLayout title="La casa caída | La despoblación de Aragón">
  <header class="header">
    <div class="header-container">
      <h3 class="header-title">
        <div class="text-wrapper">
          La casa
          <span class="letter">c</span><span class="letter">a</span><span class="letter">í</span><span class="letter">d</span><span class="letter">a</span>
        </div>
      </h3>
      <span class="author">Por <a href="https://jorgeatgu.com">Jorge Aznar</a></span>
      <p class="header-ronda">
        <span class="header-ronda-text">Delante de esta puerta cerrada</span>
        <span class="header-ronda-text">la ronda lleva tanto sin parar.</span>
        <span class="header-ronda-text">Por esa ventaneta hoy tan sombría,</span>
        <span class="header-ronda-text">en otro tiempo nanas se escuchaba cantar.</span>
        <span class="header-ronda-text">Febrero tras febrero, eterno invierno,</span>
        <span class="header-ronda-text">a esta puerta la vida ya no ha vuelto a llamar.</span>
        <a href="https://www.youtube.com/watch?v=DbanIqZdbzo" class="header-ronda-text">La Ronda de Boltaña - La casa caída</a>
      </p>
      <div class="section-text">
        <div class="container-chart">
          <p class="text">La casa caída es una bonita y triste canción de la <a href="http://www.rondadors.com/d2/18/d2_18.php">Ronda de Boltaña</a>, trata sobre la despoblación del Alto Aragón. <span class="bold">Si se nos cae la casa se vuelve a levantar,</span> canta la Ronda. El problema al que nos enfrentamos en Aragón(y en otras partes de España) es que cada día esta más cerca el momento donde no haya nadie para levantar la casa.</p>
          <p class="text">Según el INE el número total de habitantes en Aragón es de 1.341.289. <span class="bold">El 50.88% de ellos reside en la ciudad de Zaragoza</span>. Estas cifras dejan la densidad de población de Aragón en 28,11 hab/km2, solo por delante de Castilla y León, Castilla-La Mancha y Extremadura.</p>
          <article class="sponsor-card">
            <p class="sponsor-card-text">Actualizado el <strong>21 de marzo de 2025.</strong></p>
            <p class="sponsor-card-text">Los datos corresponden al padrón del INE a <strong>fecha 1 de enero de 2025.</strong></p>
          </article>
          <article class="sponsor-card">
            <p class="sponsor-card-text">Puedes apoyar económicamente este proyecto en:</p>
            <a href="https://www.buymeacoffee.com/jorgeatgu"><img src="https://img.buymeacoffee.com/button-api/?text=Buy me a keyboard&emoji=❤️&slug=jorgeatgu&button_colour=5F7FFF&font_colour=ffffff&font_family=Inter&outline_colour=000000&coffee_colour=FFDD00"></a>
            <a class="github-button" href="https://github.com/sponsors/jorgeatgu" data-color-scheme="no-preference: light; light: light_high_contrast; dark: light;" data-icon="octicon-heart" data-size="large" aria-label="Sponsor @jorgeatgu on GitHub">Sponsor</a>
          </article>
        </div>
      </div>
    </div>
    <!-- Gráfico de desierto demográfico -->
    <div class="container-chart">
      <h4 class="subtittle">Aragón, un desierto demográfico</h4>
      <p class="text">
        <!-- ... -->
      </p>
      <div class="scatter-desert">
        <svg class="scatter-chart">
          <g class="scatter-desert-container"></g>
        </svg>
      </div>
    </div>
    <!-- Gráfico de distribución por provincias -->
    <div class="container-desert">
      <h4 class="subtittle">Distribución de la población en Aragón</h4>
      <p class="text">
        <!-- ... -->
      </p>
      <div class="aragon-stack">
        <svg>
          <g class="aragon-stack-container"></g>
        </svg>
      </div>
    </div>
  </header>
  <!-- Enlaces a las provincias -->
  <section class="provinces-section">
    <div class="province-card">
      <h2>Huesca</h2>
      <p>
        <!-- Descripción -->
      </p>
      <a href="/provincia/huesca">Ver municipios de Huesca</a>
    </div>
    <div class="province-card">
      <h2>Teruel</h2>
      <p>
        <!-- Descripción -->
      </p>
      <a href="/provincia/teruel">Ver municipios de Teruel</a>
    </div>
    <div class="province-card">
      <h2>Zaragoza</h2>
      <p>
        <!-- Descripción -->
      </p>
      <a href="/provincia/zaragoza">Ver municipios de Zaragoza</a>
    </div>
  </section>
</BaseLayout>
<script>
import { scatterDesert } from '../scripts/d3/scatterDesert';
import { aragonStacked } from '../scripts/d3/aragonStacked';
import anime from 'animejs/lib/anime.es.js';

// Inicializar gráficos
document.addEventListener('DOMContentLoaded', () => {
  scatterDesert();
  aragonStacked();

  // Animación del título
  anime.timeline()
    .add({
      targets: '.header-title .letter',
      translateY: [0, '1.5rem'],
      translateZ: 0,
      duration: 750,
      delay: anime.stagger(500)
    })
    .add({
      targets: '.letter',
      translateY: ['1.5rem', '2rem'],
      translateZ: 0,
      rotate: 45,
      duration: 750,
      delay: anime.stagger(1000)
    });
});
</script>
