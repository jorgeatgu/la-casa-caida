const widthMobile=window.innerWidth>0?window.innerWidth:screen.width;function menu(){var t=document.querySelector(".overlay"),e=document.querySelector(".navegacion"),a=document.querySelector("body"),s=document.querySelectorAll(".navegacion-btn"),n=document.querySelector(".burger");function o(){n.classList.toggle("clicked"),t.classList.toggle("show"),e.classList.toggle("show"),a.classList.toggle("overflow")}for(document.querySelector(".burger").addEventListener("click",o),document.querySelector(".overlay").addEventListener("click",o),i=0;i<s.length;i++)s[i].addEventListener("click",function(){c(),console.log("click")});function c(){t.classList.remove("show"),e.classList.remove("show"),n.classList.remove("clicked")}}function animation(){anime.timeline().add({targets:".header-title .letter",translateY:[0,"1.5rem"],translateZ:0,duration:750,delay:anime.stagger(500)}).add({targets:".letter",translateY:["1.5rem","2rem"],translateZ:0,rotate:45,duration:750,delay:anime.stagger(1e3)})}const scatterDesert=()=>{const t=24,e=24,a=24,s=72;let n=0,o=0,c=0,i=0;const r=d3.select(".scatter-desert"),l=r.select("svg"),d={};let p;const u=p=>{c=r.node().offsetWidth,n=c-s-e,o=(i=600)-t-a,l.attr("width",c).attr("height",i);const u=`translate(${s},${t})`,m=l.select(".scatter-desert-container");m.attr("transform",u),((t,e)=>{d.count.x.range([0,t]),d.count.y.range([e,0])})(n,o);const y=r.select(".scatter-desert-container-bis").selectAll(".circle-desert").data(p),g=y.enter().append("circle").attr("class","circle-desert");y.merge(g).attr("cx",t=>Math.random()*n).attr("cy",t=>d.count.y(t.densidad)).attr("r",3).attr("fill",t=>t.densidad>=10?"#3b2462":"#B41248").attr("fill-opacity",.8),(t=>{const e=d3.axisBottom(d.count.x).tickFormat(d3.format("d")).ticks(0);t.select(".axis-x").attr("transform",`translate(0,${o})`).call(e);const a=d3.axisLeft(d.count.y).tickFormat(t=>t+" hab/km2").tickSize(-n).ticks(10);t.select(".axis-y").call(a)})(m)};window.addEventListener("resize",()=>{u(p)}),d3.csv("data/aragon-municipios.csv",(t,e)=>{t?console.log(t):((p=e).forEach(t=>{t.densidad=t.densidad,t.municipio=t.municipio,t.posicion=t.posicion,t.year=t.year}),(()=>{const t=l.select(".scatter-desert-container");t.append("g").attr("class","axis axis-x"),t.append("g").attr("class","axis axis-y"),t.append("g").attr("class","scatter-desert-container-bis"),t.append("circle").attr("r",4).attr("fill","#B41248").attr("cy","94%").attr("cx","19%"),t.append("text").text("Municipios con una densidad inferior a 10hab/km2").attr("y","95%").attr("x","20%")})(),(()=>{const t=d3.scaleLinear().domain([d3.min(p,t=>t.densidad),d3.max(p,t=>t.densidad)]),e=d3.scaleLinear().domain([d3.min(p,t=>t.densidad),d3.max(p,t=>t.densidad)]);d.count={x:t,y:e}})(),u(p))})},aragonStack=()=>{const t=24,e=24,a=24,s=48;let n=0,o=0;const c=d3.select(".aragon-stack"),i=c.select("svg"),r={};let l;const d=d3.bisector(t=>t.year).left,p=c.append("div").attr("class","tooltip tooltip-stack").style("opacity",0),u=l=>{const u=c.node().offsetWidth;n=u-s-e,o=600-t-a,i.attr("width",u).attr("height",600);const m=`translate(${s},${t})`,y=i.select(".aragon-stack-container");y.attr("transform",m),y.append("rect").attr("class","overlay-dos"),y.append("g").attr("class","focus").style("display","none").append("line").attr("class","x-hover-line hover-line").attr("y1",0);const g=l.columns.slice(5),h=d3.area().x((t,e)=>r.count.x(t.data.year)).y0(t=>r.count.y(t[0])).y1(t=>r.count.y(t[1])).curve(d3.curveCardinal.tension(.6)),x=d3.stack().keys(g).order(d3.stackOrderInsideOut)(l),v=d3.scaleOrdinal().domain(g).range(["#F67460","#C54073","#5A1C7C"]);d3.scaleOrdinal(v);((t,e)=>{r.count.x.range([0,t]),r.count.y.range([e,0])})(n,o);const f=c.select(".aragon-stack-container-bis").selectAll(".area-stack").data(x),$=f.enter().append("path").attr("class","area-stack");f.merge($).transition().duration(600).ease(d3.easeLinear).style("fill",t=>v(t.key)).attr("d",h);const b=y.select(".focus"),k=y.select(".overlay-dos");b.select(".x-hover-line").attr("y2",o),k.attr("width",n+s+e).attr("height",o).on("mouseover",function(){b.style("display",null)}).on("mouseout",function(){b.style("display","none"),p.style("opacity",0)}).on("mousemove",function(){const t=c.node().offsetWidth;var e=r.count.x.invert(d3.mouse(this)[0]),a=d(l,e,1),s=l[a-1],n=l[a],o=e-s.year>n.year-e?n:s;const i=r.count.x(o.year)+50,u=i+150,m=t-i;p.style("opacity",1).html(`\n                          <span class="tooltip-number tooltip-stack-text">${o.year}</span>\n                          <span class="tooltip-stack-text">Teruel: <span class="tooltip-number">${o.teruelP}% - ${o.teruel} hab</span></span>\n                          <span class="tooltip-stack-text">Huesca: <span class="tooltip-number">${o.huescaP}% - ${o.huesca} hab</span></span>\n                          <span class="tooltip-stack-text">Zaragoza: <span class="tooltip-number">${o.zaragozaP}% - ${o.zaragoza} hab</span></span>\n                          <span class="tooltip-stack-text">Total: <span class="tooltip-number">${o.aragon} hab</span></span>\n                          `).style("top","35%").style("left",u>t?"auto":i+"px").style("right",u>t?m+"px":"auto"),b.select(".x-hover-line").attr("transform",`translate(${r.count.x(o.year)},0)`)}),(t=>{const e=d3.axisBottom(r.count.x).tickFormat(d3.format("d")).tickPadding(7).ticks(9);t.select(".axis-x").attr("transform",`translate(0,${o})`).call(e);const a=d3.axisLeft(r.count.y).tickFormat(t=>t+"%").tickSizeInner(-n).ticks(5);t.select(".axis-y").call(a)})(y)};window.addEventListener("resize",()=>{u(l)}),d3.csv("data/aragon-total.csv",(t,e)=>{t?console.log(t):((l=e).forEach(t=>{t.teruelP=t.teruelP,t.huescaP=t.huescaP,t.zaragozaP=t.zaragozaP}),(()=>{const t=i.select(".aragon-stack-container");t.append("g").attr("class","axis axis-x"),t.append("g").attr("class","axis axis-y"),t.append("g").attr("class","aragon-stack-container-bis"),t.append("text").attr("class","legend-aragon").attr("y","70%").attr("x","1%").text("Zaragoza"),t.append("text").attr("class","legend-aragon").attr("y","30%").attr("x","1%").text("Huesca"),t.append("text").attr("class","legend-aragon").attr("y","5%").attr("x","1%").text("Teruel")})(),(()=>{const t=d3.scaleTime().domain(d3.extent(l,t=>t.year)),e=d3.scaleLinear().domain([0,100]);r.count={x:t,y:e}})(),u(l))})},line=(t,e)=>{const a=0,s=8,n=24,o=56;let c=0,i=0;const r=d3.select(`.line-${e}`),l=r.select("svg"),d={};let p;var u=d3.formatDefaultLocale({decimal:",",thousands:".",grouping:[3]});const m=t=>{const p=r.node().offsetWidth;c=p-o-s,i=550-a-n,l.attr("width",p).attr("height",550);const m=`translate(${o},${a})`,y=l.select(`.line-${e}-container`);y.attr("transform",m);const g=d3.line().x(t=>d.count.x(t.year)).y(t=>d.count.y(t.total));((t,e)=>{d.count.x.range([0,t]),d.count.y.range([e,0])})(c,i);const h=r.select(`.line-${e}-container-bis`),x=h.selectAll(".line").data([t]),v=x.enter().append("path").attr("class","line").attr("stroke-width","1.5"),f=h.selectAll(".circles").data(t),$=f.enter().append("circle").attr("class","circles").attr("fill","#531f4e");x.merge(v).attr("d",g),f.merge($).attr("cx",t=>d.count.x(t.year)).attr("cy",t=>d.count.y(t.total)).attr("r",4),(t=>{const e=d3.axisBottom(d.count.x).tickFormat(d3.format("d")).ticks(9);t.select(".axis-x").attr("transform",`translate(0,${i})`).call(e);const a=d3.axisLeft(d.count.y).tickFormat(u.format(",.0f")).ticks(6).tickSizeInner(-c);t.select(".axis-y").call(a)})(y)};window.addEventListener("resize",()=>{m(p)}),d3.csv(t,(t,a)=>{t?console.log(t):((p=a).forEach(t=>{t.year=t.year,t.total=t.total}),(()=>{const t=l.select(`.line-${e}-container`);t.append("g").attr("class","axis axis-x"),t.append("g").attr("class","axis axis-y"),t.append("g").attr("class",`line-${e}-container-bis`)})(),(()=>{const t=d3.scaleTime().domain([d3.min(p,t=>t.year),d3.max(p,t=>t.year)]),e=d3.scaleLinear().domain([d3.min(p,t=>t.total/1.25),d3.max(p,t=>1.25*t.total)]);d.count={x:t,y:e}})(),m(p))})},barscatter=(t,e)=>{const a=0,s=8,n=64,o=40;let c=0,i=0,r=0,l=0;const d=d3.select(`.scatter-${e}`),p=d.select("svg"),u={};let m;const y=d.append("div").attr("class","tooltip tooltip-under-over").attr("id","tooltip-scatter").style("opacity",0),g=t=>{r=d.node().offsetWidth,c=r-o-s,i=(l=600)-a-n,p.attr("width",r).attr("height",l);const m=`translate(${o},${a})`,g=p.select(`.scatter-${e}-container`);g.attr("transform",m),((t,e)=>{u.count.x.range([0,t]),u.count.y.range([e,20])})(c,i);const h=d.select(`.scatter-${e}-container-bis`).selectAll(".scatter-circles").data(t),x=h.enter().append("circle").attr("class",`scatter-${e}-circles scatter-circles`);h.merge(x).on("mouseover",function(t){y.transition(),y.style("opacity",1).html(`<p class="tooltip-citi">${t.city}<p/>\n                        <p class="tootlip-population">Habitantes: <span class="tooltip-number">${t.population}</span><p/>\n                        <p class="tootlip-over">Mayores de 65: <span class="tooltip-number">${t.mayor}%</span><p/>\n                        <p class="tootlip-under">Menores de 18: <span class="tooltip-number">${t.menor}%</span><p/>\n                        `).style("left",r/2-150+"px").style("top","100px")}).on("mouseout",function(t){y.transition().duration(200).style("opacity",0)}).attr("cx",t=>u.count.x(t.mayor)).attr("cy",t=>u.count.y(t.menor)).attr("r",0).transition().duration(600).ease(d3.easeLinear).attr("cx",t=>u.count.x(t.mayor)).attr("cy",t=>u.count.y(t.menor)).attr("r",6),(t=>{const e=d3.axisBottom(u.count.x).tickFormat(t=>t+"%").tickPadding(11).ticks(10);t.select(".axis-x").attr("transform",`translate(0,${i})`).call(e);const a=d3.axisLeft(u.count.y).tickFormat(t=>t+"%").tickSize(-c).ticks(5);t.select(".axis-y").call(a)})(g)};d3.select(`#clear-filter-${e}`).on("click",function(){d3.select(`#percentage-over-city-${e} option`).property("selected","0"),d3.select(`#percentage-under-city-${e} option`).property("selected","0"),d3.selectAll(".tooltip-percentage").remove().exit(),new SlimSelect({select:`#percentage-over-city-${e}`,searchPlaceholder:"Filtra tu municipio"}),new SlimSelect({select:`#percentage-under-city-${e}`,searchPlaceholder:"Filtra tu municipio"}),new SlimSelect({select:`#select-city-${e}`,searchPlaceholder:"Busca tu municipio"}),d3.csv(t,(t,e)=>{(m=e).forEach(t=>{t.mayor=+t.mayor,t.menor=+t.menor,t.city=t.name}),g(m)})});const h=()=>{d3.csv(t,(a,s)=>{if(a)console.log(a);else{datos=s;const a=d3.nest().key(t=>t.name).entries(datos),n=d3.select(`#filter-city-${e}`);n.selectAll("option").data(a).enter().append("option").attr("value",t=>t.key).text(t=>t.key),n.on("change",function(){d3.select(this).property("value");d3.select(`#percentage-over-city-${e} option`).property("selected","0"),d3.select(`#percentage-under-city-${e} option`).property("selected","0"),d3.selectAll(".tooltip-percentage").remove().exit(),new SlimSelect({select:`#percentage-over-city-${e}`,searchPlaceholder:"Filtra tu municipio"}),new SlimSelect({select:`#percentage-under-city-${e}`,searchPlaceholder:"Filtra tu municipio"}),d3.csv(t,(t,a)=>{m=a;let s=d3.select(`#filter-city-${e}`).property("value"),n=new RegExp("^"+s+"$");d3.selectAll(`.scatter-${e}-circles`).transition().duration(400).attr("r",0),(m=m.filter(t=>String(t.name).match(n))).forEach(t=>{t.mayor=+t.mayor,t.menor=+t.menor,t.city=t.name}),g(m)})})}})},x=()=>{d3.select(`#percentage-over-city-${e}`).on("change",function(){d3.select(`#percentage-under-city-${e} option`).property("selected","0"),new SlimSelect({select:`#percentage-under-city-${e}`,searchPlaceholder:"Filtra tu municipio"}),new SlimSelect({select:`#select-city-${e}`,searchPlaceholder:"Busca tu municipio"}),d3.csv(t,(t,a)=>{m=a;let n=d3.select(this).property("value");d3.selectAll(`.scatter-${e}-circles`).transition().duration(400).attr("r",0),m=m.filter(t=>t.mayor>n);d.select(`.scatter-${e}-container-bis`);d3.selectAll(".tooltip-percentage").remove().exit(),d.append("div").attr("class","tooltip tooltip-percentage").html(`\n                        <p class="tootlip-population"><span class="tooltip-number">En ${m.length}</span> municipios el % de habitantes mayores de 65 años es superior al <span class="tooltip-number">${n}%</span>. <p/>\n                        `).style("right",s+"px").style("top","50px"),m.forEach(t=>{t.mayor=t.mayor,t.menor=t.menor,t.city=t.name}),g(m)})})},v=()=>{d3.select(`#percentage-under-city-${e}`).on("change",function(){d3.select(`#percentage-over-city-${e} option`).property("selected","0"),new SlimSelect({select:`#percentage-over-city-${e}`,searchPlaceholder:"Filtra tu municipio"}),new SlimSelect({select:`#select-city-${e}`,searchPlaceholder:"Busca tu municipio"}),d3.csv(t,(t,a)=>{m=a;let n=d3.select(this).property("value");d3.selectAll(`.scatter-${e}-circles`).transition().duration(400).attr("r",0),m=m.filter(t=>t.menor>n);d.select(`.scatter-${e}-container-bis`);d3.selectAll(".tooltip-percentage").remove().exit(),d.append("div").attr("class","tooltip tooltip-percentage").html(`\n                        <p class="tootlip-population"><span class="tooltip-number">En ${m.length}</span> municipios el % de habitantes menores de 18 años es superior al <span class="tooltip-number">${n}%</span>. <p/>\n                        `).style("right",s+"px").style("top","50px"),m.forEach(t=>{t.mayor=t.mayor,t.menor=t.menor,t.city=t.name}),g(m)})})};window.addEventListener("resize",()=>{g(m)}),d3.csv(t,(t,a)=>{t?console.log(t):((m=a).forEach(t=>{t.mayor=+t.mayor,t.menor=+t.menor,t.population=+t.population,t.city=t.name,t.over=t.percentagemayor,t.under=t.percentagemenor}),(()=>{const t=p.select(`.scatter-${e}-container`);t.append("g").attr("class","axis axis-x"),t.append("g").attr("class","axis axis-y"),t.append("g").attr("class",`scatter-${e}-container-bis`),t.append("text").attr("class","legend").attr("y","97%").attr("x","35%").style("text-anchor","start").text("Mayores de 65 años"),t.append("text").attr("class","legend").attr("x","-350").attr("y","-30").attr("transform","rotate(-90)").style("text-anchor","start").text("Menores de 18 años")})(),(()=>{const t=d3.scaleLinear().domain([0,75]),e=d3.scaleLinear().domain([0,d3.max(m,t=>1.75*t.menor)]);u.count={x:t,y:e}})(),g(m),h(),x(),v())})},barNegative=(t,e)=>{const a=24,s=8,n=24,o=40;let c=0,i=0,r=0,l=0;const d=d3.select(`.bar-negative-${e}`),p=d.select("svg"),u={};let m;const y=d.append("div").attr("class","tooltip tooltip-negative").style("opacity",0),g=t=>{r=d.node().offsetWidth,c=r-o-s,i=(l=600)-a-n,p.attr("width",r).attr("height",l);const m=`translate(${o},${a})`,g=p.select(`.bar-negative-${e}-container`);g.attr("transform",m),((t,e)=>{u.count.x.rangeRound([0,t]).paddingInner(.2),u.count.y.range([0,e])})(c,i);const h=d.select(`.bar-negative-${e}-container-bis`).selectAll(".bar-vertical").data(t),x=h.enter().append("rect").attr("class",t=>t.saldo<0?"negative":"positive");h.merge(x).on("mouseover",function(t){y.transition(),y.style("opacity",1).html(`\n                        <p class="tooltip-year"><span class="tooltip-number">${t.year}</span><p/>\n                        <p class="tooltip-born">Nacidos: <span class="tooltip-number">${t.nacidos}</span><p/>\n                        <p class="tooltip-deceased">Fallecidos: <span class="tooltip-number">${t.fallecidos}</span><p/>\n                        <p class="tooltip-deceased">Saldo: <span class="tooltip-number">${t.saldo}</span><p/>\n                        `).style("left",r/2-100+"px").style("top","50px")}).on("mouseout",function(t){y.transition().duration(200).style("opacity",0)}).attr("width",t=>u.count.x.bandwidth()).attr("x",t=>u.count.x(t.year)).attr("y",t=>t.saldo>0?u.count.y(t.saldo):u.count.y(0)).attr("height",t=>Math.abs(u.count.y(t.saldo)-u.count.y(0))),(t=>{const e=d3.axisBottom(u.count.x).ticks(3).tickPadding(4).tickFormat(d3.format("d"));t.select(".axis-x").attr("transform",`translate(0,${i})`).call(e);const a=d3.axisLeft(u.count.y).tickFormat(d3.format("d")).ticks(5).tickSize(-c).tickPadding(8);t.select(".axis-y").call(a)})(g)};window.addEventListener("resize",()=>{g(m)}),d3.csv(t,(t,a)=>{t?console.log(t):((m=a).forEach(t=>{t.year=t.year,t.saldo=t.saldo,t.nacidos=t.nacidos,t.fallecidos=t.fallecidos}),(()=>{const t=p.select(`.bar-negative-${e}-container`);t.append("g").attr("class","axis axis-x"),t.append("g").attr("class","axis axis-y"),t.append("g").attr("class",`bar-negative-${e}-container-bis`)})(),(()=>{const t=d3.scaleBand().domain(m.map(t=>t.year)),e=d3.scaleLinear().domain([500,1.25*d3.max(m,t=>t.saldo)]);u.count={x:t,y:e}})(),g(m))})},barNegativeZ=()=>{const t=24,e=8,a=24,s=40;let n=0,o=0,c=0,i=0;const r=d3.select(".bar-negative-zaragoza"),l=r.select("svg"),d={};let p;const u=r.append("div").attr("class","tooltip tooltip-negative").style("opacity",0),m=p=>{c=r.node().offsetWidth,n=c-s-e,o=(i=600)-t-a,l.attr("width",c).attr("height",i);const m=`translate(${s},${t})`,y=l.select(".bar-negative-zaragoza-container");y.attr("transform",m),((t,e)=>{d.count.x.rangeRound([0,t]).paddingInner(.1),d.count.y.range([e,0])})(n,o);const g=r.select(".bar-negative-zaragoza-container-bis").selectAll(".bar-vertical").data(p),h=g.enter().append("rect").attr("class",t=>t.saldo<0?"negative":"positive");g.merge(h).on("mouseover",function(t){u.transition(),u.style("opacity",1).html(`\n                        <p class="tooltip-year"><span class="tooltip-number">${t.year}</span><p/>\n                        <p class="tooltip-born">Nacidos: <span class="tooltip-number">${t.nacidos}</span><p/>\n                        <p class="tooltip-deceased">Fallecidos: <span class="tooltip-number">${t.fallecidos}</span><p/>\n                        <p class="tooltip-deceased">Saldo: <span class="tooltip-number">${t.saldo}</span><p/>\n                        `).style("left",c/2-100+"px").style("top","50px")}).on("mouseout",function(t){u.transition().duration(200).style("opacity",0)}).attr("width",d.count.x.bandwidth()).attr("x",t=>d.count.x(t.year)).attr("y",t=>t.saldo>0?d.count.y(t.saldo):d.count.y(0)).attr("height",t=>Math.abs(d.count.y(t.saldo)-d.count.y(0))),(t=>{const e=d3.axisBottom(d.count.x).tickPadding(4).tickFormat(d3.format("d"));t.select(".axis-x").attr("transform",`translate(0,${o})`).call(e);const a=d3.axisLeft(d.count.y).tickFormat(d3.format("d")).ticks(5).tickSize(-n).tickPadding(8);t.select(".axis-y").call(a)})(y)};window.addEventListener("resize",()=>{m(p)}),d3.csv("data/zaragoza/saldo-vegetativo-total-zaragoza.csv",(t,e)=>{t?console.log(t):((p=e).forEach(t=>{t.year=t.year,t.saldo=t.saldo}),(()=>{const t=l.select(".bar-negative-zaragoza-container");t.append("g").attr("class","axis axis-x"),t.append("g").attr("class","axis axis-y"),t.append("g").attr("class","bar-negative-zaragoza-container-bis")})(),(()=>{const t=d3.scaleBand().domain(p.map(t=>t.year)),e=d3.scaleLinear().domain([d3.min(p,t=>1.25*t.saldo),d3.max(p,t=>2.5*t.saldo)]);d.count={x:t,y:e}})(),m(p))})},linePopulation=(t,e)=>{margin=widthMobile>544?{top:16,right:8,bottom:24,left:62}:{top:16,right:8,bottom:24,left:32};let a=0,s=0;const n=d3.select(`.line-population-${e}`),o=n.select("svg");let c,i,r={};const l=(t,e)=>{r.count.x.range([0,t]),r.count.y.range([e,0])},d=t=>{const e=d3.axisBottom(r.count.x).tickPadding(5).tickFormat(d3.format("d")).ticks(13);t.select(".axis-x").attr("transform",`translate(0,${s})`).transition().duration(300).ease(d3.easeLinear).call(e);const n=d3.axisLeft(r.count.y).tickPadding(5).tickFormat(d3.format("d")).tickSize(-a).ticks(6);t.select(".axis-y").transition().duration(300).ease(d3.easeLinear).call(n)};function p(t){const i=n.node().offsetWidth;a=i-margin.left-margin.right,s=500-margin.top-margin.bottom,o.attr("width",i).attr("height",500);const p=`translate(${margin.left},${margin.top})`,u=o.select(`.line-population-${e}-container`);u.attr("transform",p);const m=d3.line().x(t=>r.count.x(t.year)).y(t=>r.count.y(t.population));l(a,s);const y=n.select(`.line-population-${e}-container-bis`).selectAll(".lines").data([c]),g=y.enter().append("path").attr("class","lines");y.merge(g).transition().duration(400).ease(d3.easeLinear).attrTween("d",function(t){var e=d3.select(this).attr("d"),a=m(t);return d3.interpolatePath(e,a)}),d(u)}function u(n){d3.csv(t,(t,n)=>{c=n;let o=d3.select(`#select-city-${e}`).property("value"),l=new RegExp("^"+o+"$");(c=c.filter(t=>String(t.name).match(l))).forEach(t=>{t.population=+t.population,t.year=+t.year}),r.count.x.range([0,a]),r.count.y.range([s,0]);const d=d3.scaleTime().domain([d3.min(c,t=>t.year),d3.max(c,t=>t.year)]),u=d3.scaleLinear().domain([0,1.25*d3.max(c,t=>t.population)]);r.count={x:d,y:u},p();const m=c[0].population-c.slice(-1)[0].population,y=c.slice(-1)[0].population-c[0].population;let g=(100*m/c[0].population).toFixed(2),h=(100*y/c[0].population).toFixed(2);c[0].population>c.slice(-1)[0].population?i.data(c).html(t=>`\n                                <p class="tooltip-deceased">Desde 1900 su población ha disminuido en un <span class="tooltip-number">${g}%</span><p/>\n                                <p class="tooltip-deceased">Mayores de 65 años en 2018: <span class="tooltip-number">${t.mayor}%</span><p/>\n                                <p class="tooltip-deceased">Menores de 18 años en 2018: <span class="tooltip-number">${t.menor}%</span><p/>\n                                `).transition().duration(300).style("right",0).style("top","20px"):i.data(c).html(t=>`\n                                    <p class="tooltip-deceased">Desde 1900 su población ha aumentado en un <span class="tooltip-number">${h}%</span><p/>\n                                    <p class="tooltip-deceased">Mayores de 65 años en 2018: <span class="tooltip-number">${t.mayor}%</span><p/>\n                                    <p class="tooltip-deceased">Menores de 18 años en 2018: <span class="tooltip-number">${t.menor}%</span><p/>\n                                    `).transition().duration(300).style("right",0).style("top","75%")})}window.addEventListener("resize",()=>{p()}),d3.csv(t,(t,a)=>{t?console.log(t):((c=a).forEach(t=>{t.year=+t.year,t.name=t.name,t.population=+t.population}),(()=>{const t=o.select(`.line-population-${e}-container`);t.append("g").attr("class","axis axis-x"),t.append("g").attr("class","axis axis-y"),t.append("g").attr("class",`line-population-${e}-container-bis`)})(),(()=>{const t=d3.scaleTime().domain([d3.min(c,t=>t.year),d3.max(c,t=>t.year)]),e=d3.scaleLinear().domain([0,1.25*d3.max(c,t=>t.population)]);r.count={x:t,y:e}})(),p(),(t=>{n.node().offsetWidth,i=n.append("div").attr("class","tooltip tooltip-over");const e=c[0].population-c.slice(-1)[0].population,a=c.slice(-1)[0].population-c[0].population;let s=(100*e/c[0].population).toFixed(2),o=(100*a/c[0].population).toFixed(2);c[0].population>c.slice(-1)[0].population?i.data(c).html(t=>`\n                    <p class="tooltip-deceased">Desde 1900 su población ha disminuido en un <span class="tooltip-number">${s}%</span><p/>\n                    <p class="tooltip-deceased">Mayores de 65 años en 2018: <span class="tooltip-number">${t.mayor}%</span><p/>\n                    <p class="tooltip-deceased">Menores de 18 años en 2018: <span class="tooltip-number">${t.menor}%</span><p/>\n                    `).transition().duration(300).style("right",0).style("top","20px"):i.data(c).html(t=>`\n                        <p class="tooltip-deceased">Desde 1900 su población ha aumentado en un <span class="tooltip-number">${o}%</span><p/>\n                        <p class="tooltip-deceased">Mayores de 65 años en 2018: <span class="tooltip-number">${t.mayor}%</span><p/>\n                        <p class="tooltip-deceased">Menores de 18 años en 2018: <span class="tooltip-number">${t.menor}%</span><p/>\n                        `).transition().duration(300).style("right",0).style("top","90%")})(),mes=c[0].name,u(mes))}),d3.csv(t,(t,a)=>{if(t)console.log(t);else{c=a;const t=d3.nest().key(t=>t.select).entries(c),s=d3.select(`#select-city-${e}`);s.selectAll("option").data(t).enter().append("option").attr("value",t=>t.key).text(t=>t.key),s.on("change",function(){d3.select(this).property("value"),u()})}})};menu(),animation(),scatterDesert(),aragonStack(),csvTotal=["data/huesca/huesca-total.csv","data/teruel/teruel-total.csv","data/zaragoza/zaragoza-total.csv"],csvUnder=["data/huesca/huesca-mayor-menor.csv","data/teruel/mayor-menor-teruel.csv","data/zaragoza/zaragoza-mayor-menor.csv"],csvBalance=["data/huesca/saldo-vegetativo-total-huesca.csv","data/teruel/saldo-vegetativo-total-teruel.csv"],csvCities=["data/huesca/huesca.csv","data/teruel/teruel.csv","data/zaragoza/zaragoza.csv"],cities=["huesca","teruel","zaragoza"],linePopulation(csvCities[0],cities[0]),linePopulation(csvCities[1],cities[1]),linePopulation(csvCities[2],cities[2]),barNegativeZ(),line(csvTotal[0],cities[0]),line(csvTotal[1],cities[1]),line(csvTotal[2],cities[2]),barscatter(csvUnder[0],cities[0]),barscatter(csvUnder[1],cities[1]),barscatter(csvUnder[2],cities[2]),barNegative(csvBalance[0],cities[0]),barNegative(csvBalance[1],cities[1]),new SlimSelect({select:"#select-city-teruel",searchPlaceholder:"Busca tu municipio"}),new SlimSelect({select:"#filter-city-teruel",searchPlaceholder:"Filtra por municipio"}),new SlimSelect({select:"#percentage-over-city-teruel",searchPlaceholder:"Filtra tu municipio"}),new SlimSelect({select:"#percentage-under-city-teruel",searchPlaceholder:"Filtra tu municipio"}),new SlimSelect({select:"#select-city-huesca",searchPlaceholder:"Busca tu municipio"}),new SlimSelect({select:"#filter-city-huesca",searchPlaceholder:"Filtra tu municipio"}),new SlimSelect({select:"#percentage-over-city-huesca",searchPlaceholder:"Filtra tu municipio"}),new SlimSelect({select:"#percentage-under-city-huesca",searchPlaceholder:"Filtra tu municipio"}),new SlimSelect({select:"#select-city-zaragoza",searchPlaceholder:"Busca tu municipio"}),new SlimSelect({select:"#filter-city-zaragoza",searchPlaceholder:"Filtra tu municipio"}),new SlimSelect({select:"#percentage-over-city-zaragoza",searchPlaceholder:"Filtra tu municipio"}),new SlimSelect({select:"#percentage-under-city-zaragoza",searchPlaceholder:"Filtra tu municipio"});