!function(){"use strict";var t,e,a,n,c=window.innerWidth>0?window.innerWidth:screen.width;t=document.querySelector("#aragones"),e=document.querySelector("#castellano"),a=document.querySelector(".aragones"),n=document.querySelector(".castellano"),t.onclick=function(){n.classList.remove("active"),a.classList.remove("hidden"),a.classList.toggle("active"),n.classList.toggle("hidden"),t.classList.remove("active"),e.classList.remove("hidden"),t.classList.toggle("hidden"),e.classList.toggle("active")},e.onclick=function(){a.classList.remove("active"),n.classList.remove("hidden"),n.classList.toggle("active"),a.classList.toggle("hidden"),e.classList.remove("active"),t.classList.remove("hidden"),e.classList.toggle("hidden"),t.classList.toggle("active")},setTimeout((function(){anime.timeline().add({targets:".header-title .letter",translateY:[0,"1.5rem"],translateZ:0,duration:750,delay:anime.stagger(500)}).add({targets:".letter",translateY:["1.5rem","2rem"],translateZ:0,rotate:45,duration:750,delay:anime.stagger(1e3)})}),1e3);var o,r,s,l,u,d,p,m,y,f,v,g,h,x=function(t,e){var a,n=8,c=8,o=24,r=8,s=0,i=0,l=d3.select(".line-".concat(e)),u=l.select("svg"),d={},p=d3.select(".line-province-".concat(e)).append("div").attr("class","tooltip tooltip-population").style("opacity",0),m=d3.formatDefaultLocale({decimal:",",thousands:".",grouping:[3]}),y=function(t){var a=l.node().offsetWidth;s=a-r-c,i=550-n-o,u.attr("width",a).attr("height",550);var y="translate(".concat(r,",").concat(n,")"),f=u.select(".line-".concat(e,"-container"));f.attr("transform",y);var v=d3.line().x((function(t){return d.count.x(t.year)})).y((function(t){return d.count.y(t.total)}));!function(t,e){d.count.x.range([60,t]),d.count.y.range([e,0])}(s,i);var g=l.select(".line-".concat(e,"-container-bis")),h=g.selectAll(".line").data([t]),x=h.enter().append("path").attr("class","line").attr("stroke-width","1.5"),b=g.selectAll(".circles").data(t),k=b.enter().append("circle").attr("class","circles").attr("fill","#531f4e");h.merge(x).attr("d",v),b.merge(k).on("mouseover",(function(t){var e=d.count.x(t.year)+270,n="".concat(d3.event.pageX,"px"),c="".concat(d3.event.pageX-210,"px");p.transition(),p.style("opacity",1).html('<p class="tooltip-deceased">La población en <span class="tooltip-number">'.concat(t.year,'</span> era de <span class="tooltip-number">').concat(t.total,"</span> habitantes<p/>")).style("left",e>a?c:n).style("top","".concat(d3.event.pageY-48,"px"))})).on("mouseout",(function(){p.transition().duration(200).style("opacity",0)})).attr("cx",(function(t){return d.count.x(t.year)})).attr("cy",(function(t){return d.count.y(t.total)})).attr("r",4),function(t){var e=d3.axisBottom(d.count.x).tickFormat(d3.format("d")).ticks(9);t.select(".axis-x").attr("transform","translate(0,".concat(i,")")).call(e);var a=d3.axisLeft(d.count.y).tickFormat(m.format(",.0f")).ticks(6).tickSizeInner(-s);t.select(".axis-y").call(a),t.selectAll(".axis-y .tick text").attr("x",48).attr("dy",-5)}(f)};window.addEventListener("resize",(function(){y(a)})),d3.csv(t).then((function(t){var n,c,o;(a=t).forEach((function(t){t.year=t.year,t.total=t.total})),(n=u.select(".line-".concat(e,"-container"))).append("g").attr("class","axis axis-x"),n.append("g").attr("class","axis axis-y"),n.append("g").attr("class","line-".concat(e,"-container-bis")),c=d3.scaleTime().domain([d3.min(a,(function(t){return t.year})),d3.max(a,(function(t){return t.year}))]),o=d3.scaleLinear().domain([d3.min(a,(function(t){return t.total/1.25})),d3.max(a,(function(t){return 1.25*t.total}))]),d.count={x:c,y:o},y(a)}))},b=function(t,e){var a,n=0,c=8,o=64,r=40,s=0,i=0,l=0,u=0,d=d3.select(".scatter-".concat(e)),p=d.select("svg"),m={},y=d.append("div").attr("class","tooltip tooltip-under-over").attr("id","tooltip-scatter").style("opacity",0),f=function(t){l=d.node().offsetWidth,s=l-r-c,i=(u=600)-n-o,p.attr("width",l).attr("height",u);var a="translate(".concat(r,",").concat(n,")"),f=p.select(".scatter-".concat(e,"-container"));f.attr("transform",a),function(t,e){m.count.x.range([0,t]),m.count.y.range([e,20])}(s,i);var v=d.select(".scatter-".concat(e,"-container-bis")).selectAll(".scatter-circles").data(t),g=v.enter().append("circle").attr("class","scatter-".concat(e,"-circles scatter-circles"));v.merge(g).on("mouseover",(function(t){y.transition(),y.style("opacity",1).html('<p class="tooltip-citi">'.concat(t.city,'<p/>\n                        <p class="tootlip-population">Habitantes: <span class="tooltip-number">').concat(t.population,'</span><p/>\n                        <p class="tootlip-over">Mayores de 65: <span class="tooltip-number">').concat(t.mayor,'%</span><p/>\n                        <p class="tootlip-under">Menores de 18: <span class="tooltip-number">').concat(t.menor,"%</span><p/>\n                        ")).style("left",l/2-150+"px").style("top","100px")})).on("mouseout",(function(t){y.transition().duration(200).style("opacity",0)})).attr("cx",(function(t){return m.count.x(t.mayor)})).attr("cy",(function(t){return m.count.y(t.menor)})).attr("r",0).transition().duration(600).ease(d3.easeQuad).attr("cx",(function(t){return m.count.x(t.mayor)})).attr("cy",(function(t){return m.count.y(t.menor)})).attr("r",6),function(t){var e=d3.axisBottom(m.count.x).tickFormat((function(t){return t+"%"})).tickPadding(11).ticks(10);t.select(".axis-x").attr("transform","translate(0,".concat(i,")")).call(e);var a=d3.axisLeft(m.count.y).tickFormat((function(t){return t+"%"})).tickSize(-s).ticks(5);t.select(".axis-y").call(a)}(f)};d3.select("#clear-filter-".concat(e)).on("click",(function(){d3.select("#percentage-over-city-".concat(e," option")).property("selected","0"),d3.select("#percentage-under-city-".concat(e," option")).property("selected","0"),d3.selectAll(".tooltip-percentage").remove().exit(),new SlimSelect({select:"#percentage-over-city-".concat(e),searchPlaceholder:"Filtra tu municipio"}),new SlimSelect({select:"#percentage-under-city-".concat(e),searchPlaceholder:"Filtra tu municipio"}),new SlimSelect({select:"#select-city-".concat(e),searchPlaceholder:"Busca tu municipio"}),d3.csv(t).then((function(t){(a=t).forEach((function(t){t.mayor=+t.mayor,t.menor=+t.menor,t.city=t.name})),f(a)}))}));var v=function(){d3.csv(t).then((function(n){datos=n;var c=d3.nest().key((function(t){return t.name})).entries(datos),o=d3.select("#filter-city-".concat(e));o.selectAll("option").data(c).enter().append("option").attr("value",(function(t){return t.key})).text((function(t){return t.key})),o.on("change",(function(){d3.select(this).property("value");d3.select("#percentage-over-city-".concat(e," option")).property("selected","0"),d3.select("#percentage-under-city-".concat(e," option")).property("selected","0"),d3.selectAll(".tooltip-percentage").remove().exit(),new SlimSelect({select:"#percentage-over-city-".concat(e),searchPlaceholder:"Filtra tu municipio"}),new SlimSelect({select:"#percentage-under-city-".concat(e),searchPlaceholder:"Filtra tu municipio"}),d3.csv(t).then((function(t){a=t;var n=d3.select("#filter-city-".concat(e)).property("value"),c=new RegExp("^"+n+"$");d3.selectAll(".scatter-".concat(e,"-circles")).transition().duration(400).attr("r",0),(a=a.filter((function(t){return String(t.name).match(c)}))).forEach((function(t){t.mayor=+t.mayor,t.menor=+t.menor,t.city=t.name})),f(a)}))}))}))};window.addEventListener("resize",(function(){f(a)})),d3.csv(t).then((function(n){var o,r,s;(a=n).forEach((function(t){t.mayor=+t.mayor,t.menor=+t.menor,t.population=+t.population,t.city=t.name,t.over=t.percentagemayor,t.under=t.percentagemenor})),(o=p.select(".scatter-".concat(e,"-container"))).append("g").attr("class","axis axis-x"),o.append("g").attr("class","axis axis-y"),o.append("g").attr("class","scatter-".concat(e,"-container-bis")),o.append("text").attr("class","legend").attr("y","97%").attr("x","35%").style("text-anchor","start").text("Mayores de 65 años"),o.append("text").attr("class","legend").attr("x","-350").attr("y","-30").attr("transform","rotate(-90)").style("text-anchor","start").text("Menores de 18 años"),r=d3.scaleLinear().domain([0,75]),s=d3.scaleLinear().domain([0,d3.max(a,(function(t){return 1.75*t.menor}))]),m.count={x:r,y:s},f(a),v(),d3.select("#percentage-over-city-".concat(e)).on("change",(function(){d3.select("#percentage-under-city-".concat(e," option")).property("selected","0"),new SlimSelect({select:"#percentage-under-city-".concat(e),searchPlaceholder:"Filtra tu municipio"}),new SlimSelect({select:"#select-city-".concat(e),searchPlaceholder:"Busca tu municipio"}),d3.csv(t).then((function(t){a=t;var n=d3.select(this).property("value");d3.selectAll(".scatter-".concat(e,"-circles")).transition().duration(400).attr("r",0),a=a.filter((function(t){return t.mayor>n})),d.select(".scatter-".concat(e,"-container-bis")),d3.selectAll(".tooltip-percentage").remove().exit(),d.append("div").attr("class","tooltip tooltip-percentage").html('\n                        <p class="tootlip-population"><span class="tooltip-number">En '.concat(a.length,'</span> municipios el % de habitantes mayores de 65 años es superior al <span class="tooltip-number">').concat(n,"%</span>. <p/>\n                        ")).style("right",c+"px").style("top","50px"),a.forEach((function(t){t.mayor=t.mayor,t.menor=t.menor,t.city=t.name})),f(a)}))})),d3.select("#percentage-under-city-".concat(e)).on("change",(function(){d3.select("#percentage-over-city-".concat(e," option")).property("selected","0"),new SlimSelect({select:"#percentage-over-city-".concat(e),searchPlaceholder:"Filtra tu municipio"}),new SlimSelect({select:"#select-city-".concat(e),searchPlaceholder:"Busca tu municipio"}),d3.csv(t).then((function(t){a=t;var n=d3.select(this).property("value");d3.selectAll(".scatter-".concat(e,"-circles")).transition().duration(400).attr("r",0),a=a.filter((function(t){return t.menor>n})),d.select(".scatter-".concat(e,"-container-bis")),d3.selectAll(".tooltip-percentage").remove().exit(),d.append("div").attr("class","tooltip tooltip-percentage").html('\n                        <p class="tootlip-population"><span class="tooltip-number">En '.concat(a.length,'</span> municipios el % de habitantes menores de 18 años es superior al <span class="tooltip-number">').concat(n,"%</span>. <p/>\n                        ")).style("right",c+"px").style("top","50px"),a.forEach((function(t){t.mayor=t.mayor,t.menor=t.menor,t.city=t.name})),f(a)}))}))}))},k=function(t,e){var a,n=24,c=8,o=24,r=40,s=0,i=0,l=0,u=0,d=d3.select(".bar-negative-".concat(e)),p=d.select("svg"),m={},y=d.append("div").attr("class","tooltip tooltip-negative").style("opacity",0),f=function(t){l=d.node().offsetWidth,s=l-r-c,i=(u=600)-n-o,p.attr("width",l).attr("height",u);var a="translate(".concat(r,",").concat(n,")"),f=p.select(".bar-negative-".concat(e,"-container"));f.attr("transform",a),function(t,e){m.count.x.rangeRound([0,t]).paddingInner(.2),m.count.y.range([e,0])}(s,i);var v=d.select(".bar-negative-".concat(e,"-container-bis")).selectAll(".bar-vertical").data(t),g=v.enter().append("rect").attr("class",(function(t){return t.saldo<0?"negative":"positive"}));v.merge(g).on("mouseover",(function(t){y.transition(),y.style("opacity",1).html('\n                        <p class="tooltip-year"><span class="tooltip-number">'.concat(t.year,'</span><p/>\n                        <p class="tooltip-born">Nacidos: <span class="tooltip-number">').concat(t.nacidos,'</span><p/>\n                        <p class="tooltip-deceased">Fallecidos: <span class="tooltip-number">').concat(t.fallecidos,'</span><p/>\n                        <p class="tooltip-deceased">Saldo: <span class="tooltip-number">').concat(t.saldo,"</span><p/>\n                        ")).style("left",l/2-100+"px").style("top","50px")})).on("mouseout",(function(t){y.transition().duration(200).style("opacity",0)})).attr("width",m.count.x.bandwidth()).attr("x",(function(t){return m.count.x(t.year)})).attr("y",(function(t){return t.saldo>0?m.count.y(t.saldo):m.count.y(0)})).attr("height",(function(t){return Math.abs(m.count.y(t.saldo)-m.count.y(0))})),function(t){var e=d3.axisBottom(m.count.x).tickValues(m.count.x.domain().filter((function(t,e){return!(e%6)})));t.select(".axis-x").attr("transform","translate(0,".concat(i,")")).call(e);var a=d3.axisLeft(m.count.y).tickFormat(d3.format("d")).ticks(5).tickSize(-s).tickPadding(8);t.select(".axis-y").call(a)}(f)};window.addEventListener("resize",(function(){f(a)})),d3.csv(t).then((function(t){var n;(a=t).forEach((function(t){t.year=t.year,t.saldo=t.saldo,t.nacidos=t.nacidos,t.fallecidos=t.fallecidos})),(n=p.select(".bar-negative-".concat(e,"-container"))).append("g").attr("class","axis axis-x"),n.append("g").attr("class","axis axis-y"),n.append("g").attr("class","bar-negative-".concat(e,"-container-bis")),function(){d3.min(a,(function(t){return t.saldo}));var t=d3.max(a,(function(t){return t.saldo})),e=d3.scaleBand().domain(a.map((function(t){return t.year}))),n=d3.scaleLinear().domain([d3.min(a,(function(t){return 2*t.saldo})),d3.max(a,(function(e){return t<300?d3.max(a,(function(t){return 6*t.saldo})):d3.max(a,(function(t){return 2.5*t.saldo}))}))]);m.count={x:e,y:n}}(),f(a)}))},S=function(t,e){margin=c>544?{top:16,right:8,bottom:24,left:62}:{top:16,right:8,bottom:24,left:32};var a,n,o=0,r=0,s=d3.select(".line-population-".concat(e)),i=s.select("svg"),l={},u=d3.select(".".concat(e,"-line")).append("div").attr("class","tooltip tooltip-population").style("opacity",0);function d(t){var n=s.node().offsetWidth;o=n-margin.left-margin.right,r=500-margin.top-margin.bottom,i.attr("width",n).attr("height",500);var c="translate(".concat(margin.left,",").concat(margin.top,")"),d=i.select(".line-population-".concat(e,"-container"));d.attr("transform",c);var p=d3.line().x((function(t){return l.count.x(t.year)})).y((function(t){return l.count.y(t.population)}));!function(t,e){l.count.x.range([0,t]),l.count.y.range([e,0])}(o,r);var m=s.select(".line-population-".concat(e,"-container-bis")),y=m.selectAll(".lines").data([a]),f=m.selectAll(".circles-population").remove().exit().data(a),v=y.enter().append("path").attr("class","lines");y.merge(v).transition().duration(400).ease(d3.easeLinear).attrTween("d",(function(t){var e=d3.select(this).attr("d"),a=p(t);return d3.interpolatePath(e,a)}));var g=f.enter().append("circle").attr("class","circles-population").attr("fill","#531f4e");f.merge(g).on("mouseover",(function(t){var e=l.count.x(t.year)+270,a="".concat(d3.event.pageX,"px"),c="".concat(d3.event.pageX-210,"px");u.transition(),u.style("opacity",1).html('<p class="tooltip-deceased">La población en <span class="tooltip-number">'.concat(t.year,'</span> era de <span class="tooltip-number">').concat(t.population,"</span> habitantes<p/>")).style("left",e>n?c:a).style("top","".concat(d3.event.pageY-48,"px"))})).on("mouseout",(function(){u.transition().duration(200).style("opacity",0)})).attr("cx",(function(t){return l.count.x(t.year)})).attr("cy",(function(t){return l.count.y(t.population)})).attr("r",0).transition().duration(400).ease(d3.easeLinear).attr("cx",(function(t){return l.count.x(t.year)})).attr("cy",(function(t){return l.count.y(t.population)})).attr("r",4),function(t){var e=d3.axisBottom(l.count.x).tickPadding(5).tickFormat(d3.format("d")).ticks(13);t.select(".axis-x").attr("transform","translate(0,".concat(r,")")).transition().duration(300).ease(d3.easeLinear).call(e);var a=d3.axisLeft(l.count.y).tickPadding(5).tickFormat(d3.format("d")).tickSize(-o).ticks(6);t.select(".axis-y").transition().duration(300).ease(d3.easeLinear).call(a)}(d)}function p(c){d3.csv(t).then((function(t){a=t;var c=d3.select("#select-city-".concat(e)).property("value"),s=new RegExp("^"+c+"$");(a=a.filter((function(t){return String(t.name).match(s)}))).forEach((function(t){t.population=+t.population,t.year=+t.year})),l.count.x.range([0,o]),l.count.y.range([r,0]);var i=d3.scaleTime().domain([d3.min(a,(function(t){return t.year})),d3.max(a,(function(t){return t.year}))]),u=d3.scaleLinear().domain([0,1.25*d3.max(a,(function(t){return t.population}))]);l.count={x:i,y:u},d();var p=a[0].population-a.slice(-1)[0].population,m=a.slice(-1)[0].population-a[0].population,y=(100*p/a[0].population).toFixed(2),f=(100*m/a[0].population).toFixed(2);a[0].population>a.slice(-1)[0].population?n.data(a).html((function(t){return'\n                                  <p class="tooltip-deceased">Desde 1900 su población ha disminuido en un <span class="tooltip-number">'.concat(y,'%</span><p/>\n                                  <p class="tooltip-deceased">Mayores de 65 años en 2018: <span class="tooltip-number">').concat(t.mayor,'%</span><p/>\n                                  <p class="tooltip-deceased">Menores de 18 años en 2018: <span class="tooltip-number">').concat(t.menor,"%</span><p/>\n                                  ")})).transition().duration(300).style("top","20px"):n.data(a).html((function(t){return'\n                                      <p class="tooltip-deceased">Desde 1900 su población ha aumentado en un <span class="tooltip-number">'.concat(f,'%</span><p/>\n                                      <p class="tooltip-deceased">Mayores de 65 años en 2018: <span class="tooltip-number">').concat(t.mayor,'%</span><p/>\n                                      <p class="tooltip-deceased">Menores de 18 años en 2018: <span class="tooltip-number">').concat(t.menor,"%</span><p/>\n                                      ")})).transition().duration(300).style("top","75%")}))}window.addEventListener("resize",(function(){d()})),d3.csv(t).then((function(t){var c,o,r;(a=t).forEach((function(t){t.year=+t.year,t.name=t.name,t.population=+t.population})),(c=i.select(".line-population-".concat(e,"-container"))).append("g").attr("class","axis axis-x"),c.append("g").attr("class","axis axis-y"),c.append("g").attr("class","line-population-".concat(e,"-container-bis")),o=d3.scaleTime().domain([d3.min(a,(function(t){return t.year})),d3.max(a,(function(t){return t.year}))]),r=d3.scaleLinear().domain([0,1.25*d3.max(a,(function(t){return t.population}))]),l.count={x:o,y:r},d(),function(t){s.node().offsetWidth,n=s.append("div").attr("class","tooltip tooltip-over");var e=a[0].population-a.slice(-1)[0].population,c=a.slice(-1)[0].population-a[0].population,o=(100*e/a[0].population).toFixed(2),r=(100*c/a[0].population).toFixed(2);a[0].population>a.slice(-1)[0].population?n.data(a).html((function(t){return'\n                    <p class="tooltip-deceased">Desde 1900 su población ha disminuido en un <span class="tooltip-number">'.concat(o,'%</span><p/>\n                    <p class="tooltip-deceased">Mayores de 65 años en 2018: <span class="tooltip-number">').concat(t.mayor,'%</span><p/>\n                    <p class="tooltip-deceased">Menores de 18 años en 2018: <span class="tooltip-number">').concat(t.menor,"%</span><p/>\n                    ")})).transition().duration(300).style("top","20px"):n.data(a).html((function(t){return'\n                        <p class="tooltip-deceased">Desde 1900 su población ha aumentado en un <span class="tooltip-number">'.concat(r,'%</span><p/>\n                        <p class="tooltip-deceased">Mayores de 65 años en 2018: <span class="tooltip-number">').concat(t.mayor,'%</span><p/>\n                        <p class="tooltip-deceased">Menores de 18 años en 2018: <span class="tooltip-number">').concat(t.menor,"%</span><p/>\n                        ")})).transition().duration(300).style("top","90%")}(),mes=a[0].name,p(mes)})),d3.csv(t).then((function(t){a=t;var n=d3.nest().key((function(t){return t.select})).entries(a),c=d3.select("#select-city-".concat(e));c.selectAll("option").data(n).enter().append("option").attr("value",(function(t){return t.key})).text((function(t){return t.key})),c.on("change",(function(){d3.select(this).property("value"),p()}))}))};!function(){var t=document.querySelector(".overlay"),e=document.querySelector(".navegacion"),a=document.querySelector("body"),n=document.querySelectorAll(".navegacion-btn"),c=document.querySelector(".burger");function o(){c.classList.toggle("clicked"),t.classList.toggle("show"),e.classList.toggle("show"),a.classList.toggle("overflow")}for(document.querySelector(".burger").addEventListener("click",o),document.querySelector(".overlay").addEventListener("click",o),i=0;i<n.length;i++)n[i].addEventListener("click",(function(){r()}));function r(){t.classList.remove("show"),e.classList.remove("show"),c.classList.remove("clicked")}}(),r=24,s=24,l=48,u=72,d=0,p=0,m=0,y=0,f=d3.select(".scatter-desert"),v=f.select("svg"),g={},h=function(t){m=f.node().offsetWidth,d=m-u-s,p=(y=600)-r-l,v.attr("width",m).attr("height",y);var e="translate(".concat(u,",").concat(r,")"),a=v.select(".scatter-desert-container");a.attr("transform",e),function(t,e){g.count.x.range([0,t]),g.count.y.range([e,0])}(d,p);var n=f.select(".scatter-desert-container-bis").selectAll(".circle-desert").data(t),c=n.enter().append("circle").attr("class","circle-desert");n.merge(c).attr("cx",(function(t){return Math.random()*d})).attr("cy",(function(t){return g.count.y(t.densidad)})).attr("r",3).attr("fill",(function(t){return t.densidad>=10?"#3b2462":"#B41248"})).attr("fill-opacity",.8),function(t){var e=d3.axisBottom(g.count.x).tickFormat(d3.format("d")).ticks(0);t.select(".axis-x").attr("transform","translate(0,".concat(p,")")).call(e);var a=d3.axisLeft(g.count.y).tickFormat((function(t){return t+" hab/km2"})).tickSize(-d).ticks(10);t.select(".axis-y").call(a)}(a)},window.addEventListener("resize",(function(){h(o)})),d3.csv("data/aragon-municipios.csv").then((function(t){var e,a,n;(o=t).forEach((function(t){t.densidad=t.densidad,t.municipio=t.municipio,t.posicion=t.posicion,t.year=t.year})),(e=v.select(".scatter-desert-container")).append("g").attr("class","axis axis-x"),e.append("g").attr("class","axis axis-y"),e.append("g").attr("class","scatter-desert-container-bis"),e.append("circle").attr("r",3).attr("fill","#B41248").attr("cy","94%").attr("cx","4%"),e.append("text").text("Municipios con una densidad inferior a 10hab/km2").attr("y","95%").attr("x","5%"),a=d3.scaleLinear().domain([d3.min(o,(function(t){return t.densidad})),d3.max(o,(function(t){return t.densidad}))]),n=d3.scaleLinear().domain([d3.min(o,(function(t){return t.densidad})),d3.max(o,(function(t){return t.densidad}))]),g.count={x:a,y:n},h(o)})),function(){var t,e=24,a=8,n=24,c=32,o=0,r=0,s=d3.select(".aragon-stack"),i=s.select("svg"),l={},u=d3.bisector((function(t){return t.year})).left,d=s.append("div").attr("class","tooltip tooltip-stack").style("opacity",0),p=function(t){var p=s.node().offsetWidth;o=p-c-a,r=600-e-n,i.attr("width",p).attr("height",600);var m="translate(".concat(c,",").concat(e,")"),y=i.select(".aragon-stack-container");y.attr("transform",m),y.append("rect").attr("class","overlay-dos"),y.append("g").attr("class","focus").style("display","none").append("line").attr("class","x-hover-line hover-line").attr("y1",0);var f=t.columns.slice(5),v=d3.area().x((function(t,e){return l.count.x(t.data.year)})).y0((function(t){return l.count.y(t[0])})).y1((function(t){return l.count.y(t[1])})).curve(d3.curveCardinal.tension(.6)),g=d3.stack().keys(f).order(d3.stackOrderInsideOut)(t),h=d3.scaleOrdinal().domain(f).range(["#F67460","#C54073","#5A1C7C"]);d3.scaleOrdinal(h);!function(t,e){l.count.x.range([0,t]),l.count.y.range([e,0])}(o,r);var x=s.select(".aragon-stack-container-bis").selectAll(".area-stack").data(g),b=x.enter().append("path").attr("class","area-stack");x.merge(b).transition().duration(600).ease(d3.easeLinear).style("fill",(function(t){return h(t.key)})).attr("d",v);var k=y.select(".focus"),S=y.select(".overlay-dos");k.select(".x-hover-line").attr("y2",r),S.attr("width",o+c+a).attr("height",r).on("mouseover",(function(){k.style("display",null)})).on("mouseout",(function(){k.style("display","none"),d.style("opacity",0)})).on("mousemove",(function(){var e=s.node().offsetWidth,a=l.count.x.invert(d3.mouse(this)[0]),n=u(t,a,1),c=t[n-1],o=t[n],r=a-c.year>o.year-a?o:c,i=l.count.x(r.year)+33,p=i+200,m=e-i;d.style("opacity",1).html('\n                          <span class="tooltip-stack-number tooltip-stack-text">'.concat(r.year,'</span>\n                          <span class="tooltip-stack-text">Huesca: <span class="tooltip-number">').concat(r.huescaP,"% - ").concat(r.huesca,' hab.</span></span>\n                          <span class="tooltip-stack-text">Teruel: <span class="tooltip-number">').concat(r.teruelP,"% - ").concat(r.teruel,' hab.</span></span>\n                          <span class="tooltip-stack-text">Zaragoza: <span class="tooltip-number">').concat(r.zaragozaP,"% - ").concat(r.zaragoza,' hab.</span></span>\n                          <span class="tooltip-stack-text">Total: <span class="tooltip-number">').concat(r.aragon," hab.</span></span>\n                          ")).style("top","35%").style("left",p>e?"auto":i+"px").style("right",p>e?m+"px":"auto"),k.select(".x-hover-line").attr("transform","translate(".concat(l.count.x(r.year),",",0,")"))})),function(t){var e=d3.axisBottom(l.count.x).tickFormat(d3.format("d")).tickPadding(7).ticks(9);t.select(".axis-x").attr("transform","translate(0,".concat(r,")")).call(e);var a=d3.axisLeft(l.count.y).tickFormat((function(t){return t+"%"})).tickSizeInner(-o).ticks(12);t.select(".axis-y").call(a)}(y)};window.addEventListener("resize",(function(){p(t)})),d3.csv("data/aragon-total.csv").then((function(e){var a,n,c;(t=e).forEach((function(t){t.teruelP=t.teruelP,t.huescaP=t.huescaP,t.zaragozaP=t.zaragozaP})),(a=i.select(".aragon-stack-container")).append("g").attr("class","axis axis-x"),a.append("g").attr("class","axis axis-y"),a.append("g").attr("class","aragon-stack-container-bis"),a.append("text").attr("class","legend-aragon").attr("y","70%").attr("x","1%").text("Zaragoza"),a.append("text").attr("class","legend-aragon").attr("y","5%").attr("x","1%").text("Huesca"),a.append("text").attr("class","legend-aragon").attr("y","30%").attr("x","1%").text("Teruel"),n=d3.scaleTime().domain(d3.extent(t,(function(t){return t.year}))),c=d3.scaleLinear().domain([0,100]),l.count={x:n,y:c},p(t)}))}(),csvTotal=["data/huesca/huesca-total.csv","data/teruel/teruel-total.csv","data/zaragoza/zaragoza-total.csv"],csvUnder=["data/huesca/huesca-mayor-menor.csv","data/teruel/mayor-menor-teruel.csv","data/zaragoza/zaragoza-mayor-menor.csv"],csvBalance=["data/huesca/saldo-vegetativo-total-huesca.csv","data/teruel/saldo-vegetativo-total-teruel.csv","data/zaragoza/saldo-vegetativo-total-zaragoza.csv"],csvCities=["data/huesca/huesca.csv","data/teruel/teruel.csv","data/zaragoza/zaragoza.csv"],csvLB=["data/2015-2018/huesca/huesca-total.csv","data/2015-2018/teruel/teruel-total.csv","data/2015-2018/zaragoza/zaragoza-total.csv"],cities=["huesca","teruel","zaragoza"],S(csvCities[0],cities[0]),S(csvCities[1],cities[1]),S(csvCities[2],cities[2]),x(csvTotal[0],cities[0]),x(csvTotal[1],cities[1]),x(csvTotal[2],cities[2]),b(csvUnder[0],cities[0]),b(csvUnder[1],cities[1]),b(csvUnder[2],cities[2]),k(csvBalance[0],cities[0]),k(csvBalance[1],cities[1]),k(csvBalance[2],cities[2]),new SlimSelect({select:"#select-city-teruel",searchPlaceholder:"Busca tu municipio"}),new SlimSelect({select:"#filter-city-teruel",searchPlaceholder:"Filtra por municipio"}),new SlimSelect({select:"#percentage-over-city-teruel",searchPlaceholder:"Filtra tu municipio"}),new SlimSelect({select:"#percentage-under-city-teruel",searchPlaceholder:"Filtra tu municipio"}),new SlimSelect({select:"#select-city-huesca",searchPlaceholder:"Busca tu municipio"}),new SlimSelect({select:"#filter-city-huesca",searchPlaceholder:"Filtra tu municipio"}),new SlimSelect({select:"#percentage-over-city-huesca",searchPlaceholder:"Filtra tu municipio"}),new SlimSelect({select:"#percentage-under-city-huesca",searchPlaceholder:"Filtra tu municipio"}),new SlimSelect({select:"#select-city-zaragoza",searchPlaceholder:"Busca tu municipio"}),new SlimSelect({select:"#filter-city-zaragoza",searchPlaceholder:"Filtra tu municipio"}),new SlimSelect({select:"#percentage-over-city-zaragoza",searchPlaceholder:"Filtra tu municipio"}),new SlimSelect({select:"#percentage-under-city-zaragoza",searchPlaceholder:"Filtra tu municipio"})}();
